<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المحاسب الشخصي المتكامل - إدارة مالية شاملة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- إضافة خط عربي -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* إصلاحات فورية */
        body {
            font-family: 'Tajawal', sans-serif;
            padding-bottom: 20px;
        }
        
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        #dashboard {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }
        
        .btn {
            border-radius: 8px;
            font-weight: 600;
        }
        
        .table th {
            background-color: #f8f9fa;
            font-weight: 700;
        }
        
        .income-badge {
            background-color: #d4edda;
            color: #155724;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
        }
        
        .expense-badge {
            background-color: #f8d7da;
            color: #721c24;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
    <!-- شريط التنقل -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showSection('dashboard')">
                <i class="fas fa-calculator me-2"></i>المحاسب الشخصي
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" onclick="showSection('dashboard')">
                            <i class="fas fa-home"></i> الرئيسية
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSection('transactions')">
                            <i class="fas fa-exchange-alt"></i> المعاملات
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-calculator"></i> الحاسبات
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="showSection('loanCalculator')">حاسبة القروض</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showSection('mortgageCalculator')">حاسبة العقار</a></li>
                            <li><a class="dropdown-item" href="#" onclick="showSection('savingsCalculator')">حاسبة التوفير</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showSection('reports')">
                            <i class="fas fa-chart-bar"></i> التقارير
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- الحاوية الرئيسية -->
    <div class="container-fluid mt-4">
        <div class="row">
            <!-- القائمة الجانبية -->
            <div class="col-lg-3 col-md-4">
                <div class="card shadow mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="fas fa-bars"></i> القائمة الرئيسية</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="list-group list-group-flush">
                            <a href="#" class="list-group-item list-group-item-action active" onclick="showSection('dashboard')">
                                <i class="fas fa-tachometer-alt me-2"></i>لوحة التحكم
                            </a>
                            <a href="#" class="list-group-item list-group-item-action" onclick="showSection('transactions')">
                                <i class="fas fa-exchange-alt me-2"></i>إدارة المعاملات
                            </a>
                            <a href="#" class="list-group-item list-group-item-action" onclick="showSection('loanCalculator')">
                                <i class="fas fa-hand-holding-usd me-2"></i>حاسبة القروض
                            </a>
                            <a href="#" class="list-group-item list-group-item-action" onclick="showSection('mortgageCalculator')">
                                <i class="fas fa-home me-2"></i>حاسبة العقار
                            </a>
                            <a href="#" class="list-group-item list-group-item-action" onclick="showSection('savingsCalculator')">
                                <i class="fas fa-piggy-bank me-2"></i>حاسبة التوفير
                            </a>
                            <a href="#" class="list-group-item list-group-item-action" onclick="showSection('budgetPlanner')">
                                <i class="fas fa-chart-pie me-2"></i>الميزانية
                            </a>
                            <a href="#" class="list-group-item list-group-item-action" onclick="showSection('financialGoals')">
                                <i class="fas fa-bullseye me-2"></i>الأهداف
                            </a>
                            <a href="#" class="list-group-item list-group-item-action" onclick="showSection('reports')">
                                <i class="fas fa-file-invoice me-2"></i>التقارير
                            </a>
                        </div>
                    </div>
                </div>

                <!-- ملخص سريع -->
                <div class="card shadow">
                    <div class="card-header bg-info text-white">
                        <h6 class="mb-0"><i class="fas fa-info-circle"></i> ملخص سريع</h6>
                    </div>
                    <div class="card-body" id="quickSummary">
                        <div class="text-center">
                            <p class="text-muted">يتم التحميل...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- المحتوى الرئيسي -->
            <div class="col-lg-9 col-md-8">
                <!-- قسم لوحة التحكم -->
                <div id="dashboard" class="content-section">
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card bg-success text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h6 class="card-title">إجمالي الدخل</h6>
                                            <h3 id="totalIncome">0 ر.س</h3>
                                        </div>
                                        <i class="fas fa-money-bill-wave fa-2x opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-danger text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h6 class="card-title">إجمالي المصروفات</h6>
                                            <h3 id="totalExpense">0 ر.س</h3>
                                        </div>
                                        <i class="fas fa-shopping-cart fa-2x opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-primary text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h6 class="card-title">الرصيد الحالي</h6>
                                            <h3 id="currentBalance">0 ر.س</h3>
                                        </div>
                                        <i class="fas fa-wallet fa-2x opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-warning text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h6 class="card-title">المعاملات</h6>
                                            <h3 id="totalTransactions">0</h3>
                                        </div>
                                        <i class="fas fa-exchange-alt fa-2x opacity-50"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- الرسوم البيانية -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card shadow">
                                <div class="card-header bg-info text-white">
                                    <h5 class="mb-0"><i class="fas fa-chart-pie"></i> توزيع المصروفات</h5>
                                </div>
                                <div class="card-body" style="height: 300px;">
                                    <canvas id="expensesChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card shadow">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0"><i class="fas fa-chart-line"></i> الدخل مقابل المصروفات</h5>
                                </div>
                                <div class="card-body" style="height: 300px;">
                                    <canvas id="incomeVsExpenseChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- آخر المعاملات -->
                    <div class="card shadow">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="fas fa-history"></i> آخر المعاملات</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>التاريخ</th>
                                            <th>الوصف</th>
                                            <th>الفئة</th>
                                            <th>النوع</th>
                                            <th>المبلغ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recentTransactions">
                                        <tr>
                                            <td colspan="5" class="text-center text-muted">لا توجد معاملات</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- قسم إدارة المعاملات -->
                <div id="transactions" class="content-section">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card shadow">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0"><i class="fas fa-plus-circle"></i> إضافة معاملة جديدة</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">النوع</label>
                                        <select class="form-select" id="typeSelect">
                                            <option value="income">دخل</option>
                                            <option value="expense">مصروف</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">الوصف</label>
                                        <input type="text" class="form-control" id="nameInput" placeholder="مثال: راتب شهر مارس">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">المبلغ (ريال)</label>
                                        <input type="number" class="form-control" id="amountInput" placeholder="مثال: 5000">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">التاريخ</label>
                                        <input type="date" class="form-control" id="dateInput">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">الفئة</label>
                                        <select class="form-select" id="categorySelect">
                                            <!-- سيتم تعبئته تلقائياً -->
                                        </select>
                                    </div>
                                    <button class="btn btn-success w-100" onclick="addTransaction()">
                                        <i class="fas fa-save"></i> إضافة المعاملة
                                    </button>
                                </div>
                            </div>

                            <!-- إدارة الفئات -->
                            <div class="card shadow mt-4">
                                <div class="card-header bg-info text-white">
                                    <h5 class="mb-0"><i class="fas fa-cogs"></i> إدارة الفئات</h5>
                                </div>
                                <div class="card-body">
                                    <div class="input-group mb-3">
                                        <input type="text" class="form-control" id="newCategory" placeholder="أدخل فئة جديدة">
                                        <button class="btn btn-info" onclick="addCategory()">إضافة</button>
                                    </div>
                                    <div id="categoryList">
                                        <!-- تظهر الفئات هنا -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-8">
                            <div class="card shadow">
                                <div class="card-header bg-primary text-white">
                                    <h5 class="mb-0"><i class="fas fa-list"></i> السجل المالي</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <input type="text" class="form-control" id="searchInput" placeholder="ابحث في السجل...">
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>التاريخ</th>
                                                    <th>الوصف</th>
                                                    <th>الفئة</th>
                                                    <th>النوع</th>
                                                    <th>المبلغ</th>
                                                    <th>الإجراءات</th>
                                                </tr>
                                            </thead>
                                            <tbody id="transactionTable">
                                                <tr>
                                                    <td colspan="6" class="text-center text-muted">لا توجد معاملات</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- قسم حاسبة القروض -->
                <div id="loanCalculator" class="content-section">
                    <div class="card shadow">
                        <div class="card-header bg-warning text-white">
                            <h4 class="mb-0"><i class="fas fa-hand-holding-usd"></i> حاسبة القروض الشخصية</h4>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">مبلغ القرض (ريال)</label>
                                        <input type="number" class="form-control" id="loanAmount" value="50000" min="1000" step="1000">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">مدة السداد (شهر)</label>
                                        <input type="range" class="form-range" id="loanTermRange" min="6" max="84" step="6" value="36">
                                        <div class="d-flex justify-content-between">
                                            <span>6 أشهر</span>
                                            <span id="loanTermValue">36 أشهر</span>
                                            <span>84 أشهر</span>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">نسبة الفائدة السنوية (%)</label>
                                        <input type="range" class="form-range" id="interestRateRange" min="1" max="20" step="0.5" value="8">
                                        <div class="d-flex justify-content-between">
                                            <span>1%</span>
                                            <span id="interestRateValue">8%</span>
                                            <span>20%</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-warning w-100 btn-lg" onclick="calculateLoan()">
                                        <i class="fas fa-calculator"></i> احسب القرض
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <div class="card bg-light">
                                        <div class="card-header">
                                            <h5 class="mb-0">نتائج الحساب</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="loanResults" class="text-center py-4">
                                                <p class="text-muted mb-3">أدخل بيانات القرض للحصول على النتائج</p>
                                                <i class="fas fa-calculator fa-3x text-muted"></i>
                                            </div>
                                            <div id="loanDetails" style="display: none;">
                                                <table class="table table-sm">
                                                    <tr><td>القسط الشهري</td><td id="monthlyPayment" class="fw-bold"></td></tr>
                                                    <tr><td>إجمالي المبلغ</td><td id="totalPayment"></td></tr>
                                                    <tr><td>إجمالي الفائدة</td><td id="totalInterest"></td></tr>
                                                    <tr><td>نسبة الفائدة</td><td id="interestPercentage"></td></tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- قسم حاسبة التمويل العقاري -->
                <div id="mortgageCalculator" class="content-section">
                    <div class="card shadow">
                        <div class="card-header bg-info text-white">
                            <h4 class="mb-0"><i class="fas fa-home"></i> حاسبة التمويل العقاري</h4>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">سعر العقار (ريال)</label>
                                        <input type="number" class="form-control" id="propertyPrice" value="500000" min="100000" step="10000">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">الدفعة الأولى (ريال)</label>
                                        <input type="number" class="form-control" id="downPayment" value="100000" min="0" step="10000">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">مدة التمويل (سنة)</label>
                                        <input type="range" class="form-range" id="mortgageYears" min="5" max="30" value="15">
                                        <div class="d-flex justify-content-between">
                                            <span>5 سنوات</span>
                                            <span id="mortgageYearsValue">15 سنة</span>
                                            <span>30 سنة</span>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">نسبة الفائدة (%)</label>
                                        <input type="range" class="form-range" id="mortgageInterest" min="2" max="10" step="0.25" value="4">
                                        <div class="d-flex justify-content-between">
                                            <span>2%</span>
                                            <span id="mortgageInterestValue">4%</span>
                                            <span>10%</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-info w-100 btn-lg" onclick="calculateMortgage()">
                                        <i class="fas fa-home"></i> احسب التمويل
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <div class="card bg-light">
                                        <div class="card-header">
                                            <h5 class="mb-0">نتائج التمويل العقاري</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="mortgageResults" class="text-center py-4">
                                                <p class="text-muted">أدخل بيانات العقار للحصول على النتائج</p>
                                            </div>
                                            <div id="mortgageDetails" style="display: none;">
                                                <table class="table table-sm">
                                                    <tr><td>مبلغ التمويل</td><td id="mortgageAmount"></td></tr>
                                                    <tr><td>القسط الشهري</td><td id="mortgageMonthly" class="fw-bold"></td></tr>
                                                    <tr><td>إجمالي المبلغ</td><td id="mortgageTotal"></td></tr>
                                                    <tr><td>إجمالي الفائدة</td><td id="mortgageInterestTotal"></td></tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- قسم حاسبة التوفير -->
                <div id="savingsCalculator" class="content-section">
                    <div class="card shadow">
                        <div class="card-header bg-success text-white">
                            <h4 class="mb-0"><i class="fas fa-piggy-bank"></i> حاسبة التوفير والاستثمار</h4>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">المبلغ المبدئي (ريال)</label>
                                        <input type="number" class="form-control" id="initialAmount" value="1000" min="0">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">المبلغ الشهري (ريال)</label>
                                        <input type="number" class="form-control" id="monthlyDeposit" value="500" min="0">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">مدة التوفير (سنة)</label>
                                        <input type="range" class="form-range" id="savingsYears" min="1" max="30" value="10">
                                        <div class="d-flex justify-content-between">
                                            <span>1 سنة</span>
                                            <span id="savingsYearsValue">10 سنوات</span>
                                            <span>30 سنة</span>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">العائد السنوي المتوقع (%)</label>
                                        <input type="range" class="form-range" id="annualReturn" min="1" max="20" step="0.5" value="7">
                                        <div class="d-flex justify-content-between">
                                            <span>1%</span>
                                            <span id="annualReturnValue">7%</span>
                                            <span>20%</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-success w-100 btn-lg" onclick="calculateSavings()">
                                        <i class="fas fa-chart-line"></i> احسب التوفير
                                    </button>
                                </div>
                                <div class="col-md-6">
                                    <div class="card bg-light">
                                        <div class="card-header">
                                            <h5 class="mb-0">نتائج التوفير</h5>
                                        </div>
                                        <div class="card-body">
                                            <div id="savingsResults" class="text-center py-4">
                                                <p class="text-muted">أدخل بيانات التوفير للحصول على النتائج</p>
                                            </div>
                                            <div id="savingsDetails" style="display: none;">
                                                <table class="table table-sm">
                                                    <tr><td>المبلغ النهائي</td><td id="finalAmount" class="fw-bold"></td></tr>
                                                    <tr><td>إجمالي المدخرات</td><td id="totalDeposits"></td></tr>
                                                    <tr><td>إجمالي الأرباح</td><td id="totalEarnings"></td></tr>
                                                    <tr><td>نسبة العائد</td><td id="earningsPercentage"></td></tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- أقسام أخرى -->
                <div id="budgetPlanner" class="content-section">
                    <div class="card shadow">
                        <div class="card-header bg-primary text-white">
                            <h4 class="mb-0"><i class="fas fa-chart-pie"></i> مخطط الميزانية</h4>
                        </div>
                        <div class="card-body">
                            <p class="text-center text-muted">سيتم إضافة محتوى الميزانية قريباً</p>
                        </div>
                    </div>
                </div>

                <div id="financialGoals" class="content-section">
                    <div class="card shadow">
                        <div class="card-header bg-success text-white">
                            <h4 class="mb-0"><i class="fas fa-bullseye"></i> الأهداف المالية</h4>
                        </div>
                        <div class="card-body">
                            <p class="text-center text-muted">سيتم إضافة محتوى الأهداف قريباً</p>
                        </div>
                    </div>
                </div>

                <div id="reports" class="content-section">
                    <div class="card shadow">
                        <div class="card-header bg-info text-white">
                            <h4 class="mb-0"><i class="fas fa-file-invoice"></i> التقارير</h4>
                        </div>
                        <div class="card-body">
                            <p class="text-center text-muted">سيتم إضافة محتوى التقارير قريباً</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة تعديل المعاملة -->
    <div class="modal fade" id="editModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">تعديل المعاملة</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="editId">
                    <div class="mb-3">
                        <label class="form-label">النوع</label>
                        <select class="form-select" id="editType">
                            <option value="income">دخل</option>
                            <option value="expense">مصروف</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">الوصف</label>
                        <input type="text" class="form-control" id="editName">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">المبلغ (ريال)</label>
                        <input type="number" class="form-control" id="editAmount">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">التاريخ</label>
                        <input type="date" class="form-control" id="editDate">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">الفئة</label>
                        <select class="form-select" id="editCategory">
                            <!-- سيتم تعبئته تلقائياً -->
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إلغاء</button>
                    <button type="button" class="btn btn-primary" onclick="saveEdit()">حفظ التعديلات</button>
                </div>
            </div>
        </div>
    </div>

    <!-- الفوتر -->
    <footer class="footer mt-5 py-3 bg-dark text-white">
        <div class="container text-center">
            <p class="mb-0">المحاسب الشخصي المتكامل © 2024</p>
        </div>
    </footer>

    <!-- المكتبات -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- ملفات JavaScript -->
    <script src="app.js"></script>
    
    <!-- تهيئة التطبيق -->
    <script>
        // دالة عرض الأقسام
        function showSection(sectionId) {
            // إخفاء جميع الأقسام
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // إظهار القسم المطلوب
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
            
            // تحديث القائمة النشطة
            document.querySelectorAll('.list-group-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            const activeItem = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
            if (activeItem) {
                activeItem.classList.add('active');
            }
            
            const activeNav = document.querySelector(`.nav-link[onclick="showSection('${sectionId}')"]`);
            if (activeNav) {
                activeNav.classList.add('active');
            }
        }

        // تهيئة عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof initializeApp === 'function') {
                initializeApp();
            }
            
            // إعداد مستمعين للأحداث
            setupEventListeners();
            
            // إعداد التواريخ
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dateInput').value = today;
            
            // إعداد مستمعين لحاسبات العقار والتوفير
            const mortgageYears = document.getElementById('mortgageYears');
            const mortgageInterest = document.getElementById('mortgageInterest');
            const savingsYears = document.getElementById('savingsYears');
            const annualReturn = document.getElementById('annualReturn');
            
            if (mortgageYears) {
                mortgageYears.addEventListener('input', function(e) {
                    document.getElementById('mortgageYearsValue').textContent = e.target.value + ' سنة';
                });
            }
            
            if (mortgageInterest) {
                mortgageInterest.addEventListener('input', function(e) {
                    document.getElementById('mortgageInterestValue').textContent = e.target.value + '%';
                });
            }
            
            if (savingsYears) {
                savingsYears.addEventListener('input', function(e) {
                    document.getElementById('savingsYearsValue').textContent = e.target.value + ' سنوات';
                });
            }
            
            if (annualReturn) {
                annualReturn.addEventListener('input', function(e) {
                    document.getElementById('annualReturnValue').textContent = e.target.value + '%';
                });
            }
        });

        function setupEventListeners() {
            // تحديث القيم في حاسبة القروض
            const loanTermRange = document.getElementById('loanTermRange');
            const interestRateRange = document.getElementById('interestRateRange');
            
            if (loanTermRange) {
                loanTermRange.addEventListener('input', function(e) {
                    document.getElementById('loanTermValue').textContent = e.target.value + ' أشهر';
                });
            }
            
            if (interestRateRange) {
                interestRateRange.addEventListener('input', function(e) {
                    document.getElementById('interestRateValue').textContent = e.target.value + '%';
                });
            }
        }

        // وظائف الحاسبة (مؤقتة حتى يأتي app.js)
        window.calculateLoan = function() {
            const amount = parseFloat(document.getElementById('loanAmount').value) || 50000;
            const months = parseInt(document.getElementById('loanTermRange').value) || 36;
            const rate = parseFloat(document.getElementById('interestRateRange').value) || 8;
            
            const monthlyRate = rate / 100 / 12;
            const monthlyPayment = (amount * monthlyRate * Math.pow(1 + monthlyRate, months)) / 
                                 (Math.pow(1 + monthlyRate, months) - 1);
            const totalPayment = monthlyPayment * months;
            const totalInterest = totalPayment - amount;
            
            document.getElementById('monthlyPayment').textContent = monthlyPayment.toFixed(2) + ' ر.س';
            document.getElementById('totalPayment').textContent = totalPayment.toFixed(2) + ' ر.س';
            document.getElementById('totalInterest').textContent = totalInterest.toFixed(2) + ' ر.س';
            document.getElementById('interestPercentage').textContent = ((totalInterest / amount) * 100).toFixed(2) + '%';
            
            document.getElementById('loanResults').style.display = 'none';
            document.getElementById('loanDetails').style.display = 'block';
        };

        window.calculateMortgage = function() {
            const price = parseFloat(document.getElementById('propertyPrice').value) || 500000;
            const downPayment = parseFloat(document.getElementById('downPayment').value) || 100000;
            const years = parseInt(document.getElementById('mortgageYears').value) || 15;
            const rate = parseFloat(document.getElementById('mortgageInterest').value) || 4;
            
            const loanAmount = price - downPayment;
            const months = years * 12;
            const monthlyRate = rate / 100 / 12;
            const monthlyPayment = (loanAmount * monthlyRate * Math.pow(1 + monthlyRate, months)) / 
                                 (Math.pow(1 + monthlyRate, months) - 1);
            const totalPayment = monthlyPayment * months;
            const totalInterest = totalPayment - loanAmount;
            
            document.getElementById('mortgageAmount').textContent = loanAmount.toFixed(2) + ' ر.س';
            document.getElementById('mortgageMonthly').textContent = monthlyPayment.toFixed(2) + ' ر.س';
            document.getElementById('mortgageTotal').textContent = totalPayment.toFixed(2) + ' ر.س';
            document.getElementById('mortgageInterestTotal').textContent = totalInterest.toFixed(2) + ' ر.س';
            
            document.getElementById('mortgageResults').style.display = 'none';
            document.getElementById('mortgageDetails').style.display = 'block';
        };

        window.calculateSavings = function() {
            const initial = parseFloat(document.getElementById('initialAmount').value) || 1000;
            const monthly = parseFloat(document.getElementById('monthlyDeposit').value) || 500;
            const years = parseInt(document.getElementById('savingsYears').value) || 10;
            const rate = parseFloat(document.getElementById('annualReturn').value) || 7;
            
            const months = years * 12;
            const monthlyRate = rate / 100 / 12;
            let futureValue = initial;
            
            for (let i = 0; i < months; i++) {
                futureValue = futureValue * (1 + monthlyRate) + monthly;
            }
            
            const totalDeposits = initial + (monthly * months);
            const totalEarnings = futureValue - totalDeposits;
            
            document.getElementById('finalAmount').textContent = futureValue.toFixed(2) + ' ر.س';
            document.getElementById('totalDeposits').textContent = totalDeposits.toFixed(2) + ' ر.س';
            document.getElementById('totalEarnings').textContent = totalEarnings.toFixed(2) + ' ر.س';
            document.getElementById('earningsPercentage').textContent = ((totalEarnings / totalDeposits) * 100).toFixed(2) + '%';
            
            document.getElementById('savingsResults').style.display = 'none';
            document.getElementById('savingsDetails').style.display = 'block';
        };
    </script>
</body>
</html>
